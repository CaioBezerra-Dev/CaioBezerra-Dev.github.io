<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nosso Ponto de Partida</title>
    
    <style>
        /* O CSS permanece o mesmo, não precisa mudar nada aqui */
        @import url('https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Montserrat:wght@700&display=swap');
        body{font-family:'Lora',serif;background-color:#0a192f;color:#e6f1ff;margin:0;padding:0;overflow:hidden;display:flex;justify-content:center;align-items:center;min-height:100vh;position:relative}
        .star-field{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2}
        .star{position:absolute;background-color:white;border-radius:50%;opacity:0;animation:twinkle 2s infinite alternate}
        @keyframes twinkle{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}
        .airplane{position:fixed;top:15%;width:120px;height:40px;z-index:-1;animation:fly-across 25s linear infinite}
        @keyframes fly-across{0%{left:-150px;transform:rotate(-15deg)}100%{left:110%;transform:rotate(-25deg)}}
        .airplane .fuselage{position:absolute;top:15px;left:0;width:100%;height:10px;background:linear-gradient(to top,#c0c0c0,#eaeaea);border-radius:30% 50% 50% 30% / 50%}
        .airplane .cockpit{position:absolute;top:12px;right:5px;width:18px;height:14px;background:#87ceeb;border-radius:50%;transform:rotate(10deg)}
        .airplane .left-wing,.airplane .right-wing{position:absolute;background-color:#b0b0b0;width:55px;height:10px;left:30px;border-radius:5px}
        .airplane .left-wing{top:10px;transform:rotate(25deg)}
        .airplane .right-wing{top:20px;transform:rotate(-25deg)}
        .airplane .tail-vertical{position:absolute;left:0;top:8px;width:10px;height:20px;background-color:#a0a0a0;clip-path:polygon(0 0,100% 100%,0% 100%)}
        .airplane .tail-horizontal{position:absolute;left:5px;top:20px;width:15px;height:6px;background-color:#a0a0a0;border-radius:2px;transform:rotate(10deg)}
        .container{max-width:800px;margin:2rem;padding:2.5rem 3rem;background-color:rgba(17,34,64,.85);border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.4);text-align:center;border:1px solid rgba(100,149,237,.3);backdrop-filter:blur(5px);animation:fadeIn 2s ease-in-out;position:relative;z-index:1;max-height:90vh;overflow-y:auto}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .hidden{display:none}
        #proposal-container .content p,#loading-message{font-size:1.1rem;line-height:1.8;text-align:left;margin-bottom:1.5rem;white-space:pre-wrap}
        h1,.question{font-family:'Montserrat',sans-serif;font-weight:700;color:#64ffda;text-shadow:0 0 10px rgba(100,255,218,.5)}
        h1{font-size:2.5rem;margin-bottom:2rem}
        .question{font-size:1.8rem;margin-top:3rem;margin-bottom:2rem}
        .buttons{display:flex;justify-content:center;gap:1.5rem;position:relative}
        .btn{padding:1rem 2.5rem;border:none;border-radius:50px;font-family:'Montserrat',sans-serif;font-weight:700;font-size:1.1rem;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 15px rgba(0,0,0,.2)}
        #yesBtn{background-color:#64ffda;color:#0a192f}
        #yesBtn:hover{transform:translateY(-3px);box-shadow:0 7px 20px rgba(100,255,218,.4);background-color:#79ffe1}
        #noBtn{background-color:#ff6b6b;color:#fff;position:absolute}
        #timer-container h2{font-family:'Montserrat',sans-serif;font-size:2.2rem;color:#ffd700;text-shadow:0 0 10px rgba(255,215,0,.5);margin-bottom:2rem}
        .timer-display{display:flex;justify-content:center;align-items:center;gap:1rem;flex-wrap:wrap}
        .time-block{display:flex;flex-direction:column;align-items:center}
        .time-block .number{font-family:'Montserrat',sans-serif;font-size:2.5rem;font-weight:700;color:#fff;background-color:rgba(100,255,218,.1);padding:.8rem 1rem;border-radius:10px;min-width:60px}
        .time-block .label{font-family:'Lora',serif;margin-top:.5rem;font-size:.9rem;color:#e6f1ff;text-transform:uppercase}
        @media (max-width: 600px){h1{font-size:2rem}.question{font-size:1.5rem}#timer-container h2{font-size:1.8rem}.time-block .number{font-size:1.8rem;min-width:40px;padding:.6rem .8rem}.timer-display{gap:.5rem}}
    </style>
</head>
<body>
    <div class="star-field"></div>
    <div class="airplane">
        <div class="tail-vertical"></div> <div class="tail-horizontal"></div> <div class="fuselage"></div> <div class="left-wing"></div> <div class="right-wing"></div> <div class="cockpit"></div>
    </div>
    <div class="container">
        <div id="loading-container">
            <p>Carregando nossa história...</p>
        </div>
        <div id="proposal-container" class="hidden">
            <h1>Uma Estrela Chamada Você</h1>
            <div class="content"><p>Eu nunca fui muito de acreditar em destino, mas desde que você apareceu, comecei a questionar tudo. Cada conversa, cada risada e cada momento ao seu lado parece um pequeno pedaço de um universo que eu não conhecia, mas que agora não imagino mais sem.</p></div>
            <div class="question">Você quer namorar comigo?</div>
            <div class="buttons"><button id="yesBtn" class="btn">Sim!</button><button id="noBtn" class="btn">Não</button></div>
        </div>
        <div id="timer-container" class="hidden">
            <h2>Nosso Tempo Juntos</h2>
            <div class="timer-display">
                <div class="time-block"><span class="number" id="anos">0</span><span class="label">Anos</span></div>
                <div class="time-block"><span class="number" id="dias">0</span><span class="label">Dias</span></div>
                <div class="time-block"><span class="number" id="horas">0</span><span class="label">Horas</span></div>
                <div class="time-block"><span class="number" id="minutos">0</span><span class="label">Minutos</span></div>
                <div class="time-block"><span class="number" id="segundos">0</span><span class="label">Segundos</span></div>
            </div>
        </div>
    </div>

    <script>
        // ★★★ COLE AQUI O URL DO SEU APP DA WEB DO GOOGLE APPS SCRIPT ★★★
        const SCRIPT_URL = "COLE_SEU_URL_AQUI";

        const loadingContainer = document.getElementById('loading-container');
        const proposalContainer = document.getElementById('proposal-container');
        const timerContainer = document.getElementById('timer-container');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        let timerInterval; // Variável para guardar nosso intervalo

        function iniciarContador(dataInicioISO) {
            if (!dataInicioISO) return;
            if (timerInterval) clearInterval(timerInterval); // Limpa qualquer timer antigo

            const dataInicio = new Date(dataInicioISO);

            timerInterval = setInterval(() => {
                const agora = new Date();
                const diff = agora - dataInicio;

                const msPorDia = 1000 * 60 * 60 * 24;
                const msPorAno = msPorDia * 365.25;

                const anos = Math.floor(diff / msPorAno);
                const dias = Math.floor((diff % msPorAno) / msPorDia);
                const horas = Math.floor((diff % msPorDia) / (1000 * 60 * 60));
                const minutos = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const segundos = Math.floor((diff % (1000 * 60)) / 1000);

                document.getElementById('anos').textContent = anos;
                document.getElementById('dias').textContent = dias;
                document.getElementById('horas').textContent = horas.toString().padStart(2, '0');
                document.getElementById('minutos').textContent = minutos.toString().padStart(2, '0');
                document.getElementById('segundos').textContent = segundos.toString().padStart(2, '0');
            }, 1000);
        }

        function mostrarTela(tela) {
            loadingContainer.classList.add('hidden');
            proposalContainer.classList.add('hidden');
            timerContainer.classList.add('hidden');
            
            if (tela === 'timer') {
                timerContainer.classList.remove('hidden');
            } else if (tela === 'proposal') {
                proposalContainer.classList.remove('hidden');
            } else {
                loadingContainer.classList.remove('hidden');
            }
        }

        yesBtn.addEventListener('click', () => {
            mostrarTela('loading');
            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Importante para Apps Script
                headers: { 'Content-Type': 'application/json' },
            })
            .then(() => {
                 // Após salvar, busca a data novamente para garantir que está correta
                 verificarStatus();
            })
            .catch(error => console.error('Erro ao salvar:', error));
        });
        
        function verificarStatus() {
            fetch(SCRIPT_URL)
            .then(res => res.json())
            .then(data => {
                if (data.timestamp && data.timestamp !== "") {
                    // Já foi aceito, mostrar timer
                    mostrarTela('timer');
                    iniciarContador(data.timestamp);
                } else {
                    // Ainda não foi aceito, mostrar pedido
                    mostrarTela('proposal');
                }
            }).catch(error => {
                console.error('Erro ao buscar status:', error);
                // Em caso de erro, mostrar o pedido como padrão
                mostrarTela('proposal');
            });
        }
        
        // Lógica do botão NÃO (continua a mesma)
        noBtn.addEventListener('mouseover', () => {
             const containerRect = document.querySelector('.container').getBoundingClientRect();
             const btnRect = noBtn.getBoundingClientRect();
             noBtn.style.left = `${Math.floor(Math.random() * (containerRect.width - btnRect.width))}px`;
             noBtn.style.top = `${Math.floor(Math.random() * (containerRect.height - btnRect.height))}px`;
        });
        
        // Quando a página carrega, verifica o status
        document.addEventListener('DOMContentLoaded', () => {
             // Lógica das estrelas
            const starField = document.querySelector('.star-field');
            for (let i = 0; i < 250; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                const size = Math.random() * 3 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.animationDelay = `${Math.random() * 3}s`;
                star.style.animationDuration = `${Math.random() * 2 + 2}s`;
                starField.appendChild(star);
            }
            
            verificarStatus();
        });
    </script>
</body>
</html>